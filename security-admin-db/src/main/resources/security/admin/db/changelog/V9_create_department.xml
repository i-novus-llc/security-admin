<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="201901181450_create_department" author="lgalimova">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="department" schemaName="sec"/>
            </not>
        </preConditions>
        <sql>
            create table if not exists sec.department (
                id uuid NOT NULL,
                full_name varchar NOT NULL,
                short_name varchar NOT NULL,
                creation_date timestamp,
                last_action_date timestamp,
            CONSTRAINT pk_department PRIMARY KEY (id)
            );
            comment on table sec.department is 'Подразделения';
            comment on column sec.department.id is 'Ид-р';
            comment on column sec.department.full_name is 'Полное наименование';
            comment on column sec.department.short_name is 'Сокращенное наименование';
        </sql>
    </changeSet>

    <changeSet id="201901181453_create_employee_domrf" author="lgalimova">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="employee_domrf" schemaName="sec"/>
            </not>
        </preConditions>
        <sql>
            create table if not exists sec.employee_domrf (
                id uuid NOT NULL,
                position varchar ,
                department_id uuid,
                user_id integer,
                creation_date timestamp,
                last_action_date timestamp,
            CONSTRAINT pk_employee_domrf PRIMARY KEY (id),
            CONSTRAINT employee_domrf_department_id_fk FOREIGN KEY (department_id) REFERENCES sec.department(id),
            CONSTRAINT employee_domrf_user_id_fk FOREIGN KEY (user_id) REFERENCES sec.user(id)
            );
            comment on table sec.employee_domrf is 'Уполномоченные лица Банк';

            comment on column sec.employee_domrf.id is 'Ид-р ';
            comment on column sec.employee_domrf.position is 'Должность';
            comment on column sec.employee_domrf.department_id is 'Идентификатор подразделения';
            comment on column sec.employee_domrf.user_id is 'Идентификатор пользователя';
        </sql>
    </changeSet>


</databaseChangeLog>