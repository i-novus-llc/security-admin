<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.1.xsd">

    <bean id="sqlConfigScanner" class="net.n2oapp.framework.config.register.scanner.XmlInfoScanner">
        <property name="pattern" value="classpath:net/n2oapp/security/admin/n2o/sql/*.*.xml"/>
    </bean>

    <bean id="jdbcRoleService" class="net.n2oapp.security.admin.n2o.JdbcRoleService">
        <constructor-arg name="transactionTemplate" ref="transactionTemplate"/>
    </bean>
    <bean id="jdbcUserService" class="net.n2oapp.security.admin.n2o.JdbcUserService">
        <constructor-arg name="transactionTemplate" ref="transactionTemplate"/>
        <constructor-arg name="jdbcTemplate" ref="namedParameterJdbcTemplate"/>
        <property name="passwordGenerator" ref="passwordGenerator"/>
        <property name="passwordEncoder" ref="passwordEncoder"/>
        <property name="generate" value="${sec.password.generate.enabled}"/>
        <property name="mailSubject" value="${sec.password.mail.subject}"/>
        <property name="mailBody" value="${sec.password.mail.body.path}"/>
        <property name="mailApp" value="${n2o.ui.url}"/>
    </bean>

    <bean id="passwordGenerator" class="net.n2oapp.security.admin.n2o.util.PasswordGenerator">
        <property name="length" value="${sec.password.generate.length}"/>
    </bean>
    <bean id="passwordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder"/>
</beans>