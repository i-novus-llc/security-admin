<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.1.xsd">

    <context:annotation-config/>

    <bean id="jdbcRoleService" class="net.n2oapp.security.admin.n2o.JdbcRoleService">
        <constructor-arg name="transactionTemplate" ref="transactionTemplate"/>
    </bean>
    <bean id="jdbcUserService" class="net.n2oapp.security.admin.n2o.JdbcUserService">
        <constructor-arg name="transactionTemplate" ref="transactionTemplate"/>
        <property name="passwordGenerator" ref="passwordGenerator"/>
        <property name="passwordEncoder" ref="passwordEncoder"/>
        <property name="mailSender" ref="mailSender"/>
        <property name="generate" value="${sec.password.generate.enabled}"/>
        <property name="mailSubject" value="${sec.password.mail.subject}"/>
        <property name="mailBody" value="${sec.password.mail.body.path}"/>
        <property name="mailApp" value="${n2o.ui.url}"/>
    </bean>

    <bean id="passwordGenerator" class="net.n2oapp.security.admin.n2o.util.PasswordGenerator">
        <property name="length" value="${sec.password.generate.length}"/>
    </bean>
    <bean id="passwordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder"/>

    <!-- SET default mail properties -->
    <bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
        <property name="host" value="${sec.password.mail.host}"/>
        <property name="port" value="${sec.password.mail.port}"/>
        <property name="username" value="${sec.password.mail.from.login}"/>
        <property name="password" value="${sec.password.mail.from.password}"/>
        <property name="protocol" value="smtp"/>
        <property name="javaMailProperties">
            <props>
                <prop key="mail.smtp.auth">true</prop>
                <prop key="mail.smtp.socketFactory.port">465</prop>
                <prop key="mail.smtp.socketFactory.class">javax.net.ssl.SSLSocketFactory</prop>
                <prop key="mail.smtp.socketFactory.fallback">false</prop>
                <prop key="mail.smtp.timeout">25000</prop>
            </props>
        </property>
    </bean>
</beans>