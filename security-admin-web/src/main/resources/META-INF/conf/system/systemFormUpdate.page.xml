<?xml version='1.0' encoding='UTF-8'?>
<page xmlns="http://n2oapp.net/framework/config/schema/page-2.0"
      name="Изменение карточки системы" layout="TopBottomLayout" object-id="system">

    <regions>
        <region place="top">
            <form id="main" upload="defaults" query-id="system" route="/">
                <fields>
                    <input-text id="name" label="Наименование" required="true"/>
                    <input-text id="id" label="Код" required="true" enabled="false"/>
                    <text-area id="description" label="Описание"/>
                    <field id="showOnInterface" label="Включить отображение системы в едином интерфейсе"
                           visible="${access.system.showOnInterface}">
                        <controls>
                            <checkbox id="showOnInterface" src="Switch"/>
                        </controls>
                    </field>
                    <input-text id="shortName" label="Короткое наименование">
                        <dependencies>
                            <visibility on="showOnInterface" reset="false">
                                showOnInterface
                            </visibility>
                            <requiring on="showOnInterface">
                                showOnInterface
                            </requiring>
                        </dependencies>
                    </input-text>
                    <input-text id="url" label="Адрес">
                        <dependencies>
                            <visibility on="showOnInterface" reset="false">
                                showOnInterface
                            </visibility>
                            <requiring on="showOnInterface">
                                showOnInterface
                            </requiring>
                        </dependencies>
                    </input-text>
                    <checkbox id="publicAccess" label="Допускается работа в системе без авторизации">
                        <dependencies>
                            <visibility on="showOnInterface" reset="false">
                                showOnInterface
                            </visibility>
                        </dependencies>
                    </checkbox>
                    <input-text id="viewOrder" domain="integer" label="Порядок отображения системы">
                        <dependencies>
                            <visibility on="showOnInterface" reset="false">
                                showOnInterface
                            </visibility>
                        </dependencies>
                    </input-text>
                </fields>
            </form>
        </region>
        <line place="bottom">
            <table id="services" query-id="service" depends-on="main" master-field-id="id"
                   detail-field-id="systemCode" name="Приложения" route="/applications">
                <columns>
                    <column text-field-id="id" label="Код"/>
                    <column text-field-id="name" label="Наименование"/>
                    <column text-field-id="oAuth" label="OAuth 2.0">
                        <checkbox enabled="false"/>
                    </column>
                    <column text-field-id="actions" label=" ">
                        <toolbar>
                            <button id="oAuth" icon="fa fa-exchange" type="icon" label="Протокол OAuth 2.0">
                                <show-modal page-id="oAuthSettings" submit-operation-id="persist"
                                            route="/client/:code/persist"
                                            object-id="client" master-field-id="id" detail-field-id="id"
                                            upload="defaults"
                                            page-name="Настройка протокола Oauth2.0 для {name}(Код: {id})">
                                </show-modal>
                            </button>
                            <button id="delete" label="Удалить" type="icon" icon="fa fa-trash">
                                <invoke operation-id="delete"/>
                            </button>
                        </toolbar>
                    </column>
                </columns>
                <rows>
                    <click>
                        <show-modal page-id="serviceUpdateForm" submit-operation-id="update" route="/:code/update"
                                    object-id="service"
                                    detail-field-id="id">
                        </show-modal>
                    </click>
                </rows>
                <toolbar>
                    <button id="createService" label="Создать" model="filter">
                        <show-modal page-id="serviceForm" submit-operation-id="create" model="filter"
                                    object-id="service" upload="defaults" route="/create" close-after-submit="true">
                            <pre-filters>
                                <eq field-id="systemCode" ref-widget-id="main" ref-model="resolve" value="{id}"/>
                            </pre-filters>
                        </show-modal>
                    </button>
                </toolbar>
            </table>
        </line>

    </regions>


</page>
