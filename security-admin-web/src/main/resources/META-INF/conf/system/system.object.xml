<?xml version='1.0' encoding='UTF-8'?>
<object xmlns="http://n2oapp.net/framework/config/schema/object-3.0" name="Системы">

    <operations>
        <operation id="create" success-text="Данные о системе сохранены">
            <invocation>
                <java method="createSystem" class="net.n2oapp.security.admin.api.service.ApplicationSystemService">
                    <spring/>
                    <arguments>
                        <argument type="class" class="net.n2oapp.security.admin.api.model.AppSystemForm"/>
                    </arguments>
                </java>
            </invocation>
            <in-parameters>
                <param id="id" mapping="[0].code" domain="string" required="true"/>
                <param id="name" mapping="[0].name" domain="string" required="true"/>
                <param id="description" mapping="[0].description" domain="string"/>
                <param id="shortName" mapping="[0].shortName" domain="string"/>
                <param id="url" mapping="[0].url" domain="string"/>
                <param id="publicAccess" mapping="[0].publicAccess" domain="boolean"/>
                <param id="viewOrder" mapping="[0].viewOrder" domain="integer"/>
                <param id="showOnInterface" mapping="[0].showOnInterface" domain="boolean"/>
            </in-parameters>
            <out-parameters>
                <param id="id" mapping="code"/>
            </out-parameters>
            <validations black-list="uniqSystemCode"/>
        </operation>

        <operation id="update" success-text="Данные о системе сохранены">
            <invocation>
                <java method="updateSystem" class="net.n2oapp.security.admin.api.service.ApplicationSystemService">
                    <spring/>
                    <arguments>
                        <argument type="class" class="net.n2oapp.security.admin.api.model.AppSystemForm"/>
                    </arguments>
                </java>
            </invocation>
            <in-parameters>
                <param id="id" mapping="[0].code" domain="string" required="true"/>
                <param id="name" mapping="[0].name" domain="string" required="true"/>
                <param id="description" mapping="[0].description" domain="string"/>
                <param id="shortName" mapping="[0].shortName" domain="string"/>
                <param id="url" mapping="[0].url" domain="string"/>
                <param id="publicAccess" mapping="[0].publicAccess" domain="boolean"/>
                <param id="viewOrder" mapping="[0].viewOrder" domain="integer"/>
                <param id="showOnInterface" mapping="[0].showOnInterface" domain="boolean"/>
            </in-parameters>
            <out-parameters>
                <param id="id" mapping="code"/>
            </out-parameters>
            <validations black-list="uniqSystemCode"/>
        </operation>

        <operation id="delete"
                   confirm-text="Вы уверены, что хотите удалить систему?"
                   success-text="Система удалена">
            <invocation>
                <java method="deleteSystem" class="net.n2oapp.security.admin.api.service.ApplicationSystemService">
                    <spring/>
                    <arguments>
                        <argument type="primitive"/>
                    </arguments>
                </java>
            </invocation>
            <in-parameters>
                <param id="id" mapping="[0]" domain="string" required="true"/>
            </in-parameters>
            <validations black-list="uniqSystemCode"/>
        </operation>
    </operations>

    <validations>
        <constraint id="uniqSystemCode" server-moment="before-operation" severity="danger"
                    message="Существует система с указанным кодом"
                    result="!(#this)">
            <invocation>
                <java method="isSystemExist" class="net.n2oapp.security.admin.api.service.ApplicationSystemService">
                    <spring/>
                    <arguments>
                        <argument type="primitive"/>
                    </arguments>
                </java>
            </invocation>
            <in-parameters>
                <param id="id" mapping="[0]" domain="string" required="true"/>
            </in-parameters>
        </constraint>
    </validations>
</object>





